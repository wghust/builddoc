# OneAPM Agent for Node.js

## 安装

1. 在需要监控的APP中安装oneapm模块`npm install <path/to/agent_download_directory>/oneapm-1.0.0.tgz`
2. 拷贝`node_module/oneapm/oneapm.js`到APP根目录
3. 修改配置文件oneapm.js，将`license_key`的值修改为您的Oneapm帐号中的`license_key`
4. 将`var oneapm = require('oneapm');`写到app主模块文件的第一行。

## 浏览器性能监控

将`oneapm.getBrowserTimingHeader()`写到html模板的`<head>`标签的开头。（如果`<head>`中存在`X-UA-COMPATIBLE HTTP-EQUIV`等meta tags，请将语句写到meta tags之后，以便监控的更加精准。）
####例子
*app.js*
```javascript
   var oneapm = require('oneapm');
   var app = require('express')();
   app.locals.oneapm = oneapm;
   app.get('/user/:id', function (req, res) {
      res.render('user');
   });
   app.listen(process.env.PORT);
```
*layout.jade:*

```jade
doctype html
html
  head
    != oneapm.getBrowserTimingHeader()
    title= title
    link(rel='stylesheet', href='/stylesheets/style.css')
  body
    block content
```
